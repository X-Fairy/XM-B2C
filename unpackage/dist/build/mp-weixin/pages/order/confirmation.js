(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/confirmation"],{"319d":function(e,t,i){"use strict";var n=i("f299"),s=i.n(n);s.a},"3a0d":function(e,t,i){"use strict";i.r(t);var n=i("46cf"),s=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=s.a},"46cf":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{id:"",secret:{},buylist:[],goodsPrice:0,payPrice:0,payLing:0,sumPrice:0,freight:5,note:"",int:1200,deduction:0,disType:null,disPrice:null,tips:"",minprice:0,recinfo:{},items:[],ship_name:"",shipmoney:"",choose:!1,store:""}},onLoad:function(e){this.store=e.store,this.loadData(),this.getAddress()},onShow:function(){var t=this;e.getStorage({key:"selectAddress",success:function(e){console.log("地址",e),t.recinfo=e.data}})},filters:{toFixed:function(e){return parseFloat(e).toFixed(2)}},methods:{getAddress:function(){var e=this;this.$xm.post("/Order/getDefAdr/","",function(t){console.log(t),e.recinfo=t})},loadData:function(){var e=this,t={store:this.store};this.$xm.post("/Cart",t,function(t){var i=t.prolist,n=t.allprice;e.$xm.requestImg(i),e.buylist=i,e.minprice=Number(t.minprice),e.goodsPrice=t.allprice,e.tips=t.tips,e.payPrice=Number(n),e.minprice>e.payPrice&&(e.goodsPrice=e.payPrice+e.freight),e.discounts(t.allprice)})},discounts:function(e){var t=this,i={store:this.store,money:e};this.$xm.post("/Coupon/match_optimals",i,function(e){if(e.data){t.sumPrice=e.data.money;var i=e.data.money;t.payLing=Number(i),t.minprice>t.payLing&&(t.sumPrice=t.payLing+t.freight),t.tips=e.data.msg,t.disPrice=e.data.cut,t.disType=e.data.type,t.getship()}})},getship:function(){var t=this;if(this.recinfo){var i={shipid:this.recinfo.id,allprice:this.payLing,store:this.store};this.$xm.post("/Order/getShipMoney",i,function(e){console.log(e),void 0!==e.data&&(e.data.constructor==Array?(t.items=e.data,t.items.forEach(function(e){e.checked=""}),t.items[0].checked=!0,t.ship_name=t.items[0].name,t.shipmoney=t.items[0].price,t.freight=t.items[0].price):(t.items=[],t.freight=e.data.price,t.shipmoney=e.data.price,t.ship_name=e.data.name))})}else e.showToast({title:"请选择收件地址！",icon:!1})},shipChange:function(e){var t;this.ship_name=e.detail.value,"普通快递"==e.detail.value?(t=0,this.shipmoney=5):"顺丰快递"==e.detail.value?(t=1,this.shipmoney=15):"满59包邮"==e.detail.value&&(t=0,this.shipmoney=0),this.freight=this.items[t].price,this.goodsPrice=this.payPrice+this.freight,this.sumPrice=this.payLing+this.freight},toPay:function(){var t={shipid:this.recinfo.id,shipmoney:this.shipmoney,ship_name:this.ship_name,memo:this.note,couponid:"",store:this.store};this.$xm.post("/Order/saveOrder",t,function(t){var i=t.data;1==t.s?e.requestPayment({timeStamp:i.timeStamp,nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign,success:function(e){console.log(e)},fail:function(e){console.log(e)},complete:function(t){"requestPayment:ok"==t.errMsg?e.showModal({title:"支付成功！",content:"",showCancel:!1,confirmText:"确  定",confirmColor:"#2c2c2c",success:function(t){e.redirectTo({url:"../user/order_list/order_list?tbIndex=1"})}}):e.showModal({title:"支付失败！",content:"",showCancel:!1,confirmText:"确  定",confirmColor:"#2c2c2c",success:function(e){e.confirm&&wx.redirectTo({url:"../user/order_list/order_list?tbIndex=0"})}})}}):e.showToast({title:t.msg,icon:"none"})})},selectAddress:function(){e.navigateTo({url:"../user/address/address?type=select"})}}};t.default=i}).call(this,i("543d")["default"])},"664c":function(e,t,i){"use strict";(function(e){i("e146"),i("921b");n(i("66fd"));var t=n(i("fcc6"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},"7cbe":function(e,t,i){"use strict";var n,s=function(){var e=this,t=e.$createElement;e._self._c},o=[];i.d(t,"b",function(){return s}),i.d(t,"c",function(){return o}),i.d(t,"a",function(){return n})},f299:function(e,t,i){},fcc6:function(e,t,i){"use strict";i.r(t);var n=i("7cbe"),s=i("3a0d");for(var o in s)"default"!==o&&function(e){i.d(t,e,function(){return s[e]})}(o);i("319d");var r,c=i("f0c5"),a=Object(c["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);t["default"]=a.exports}},[["664c","common/runtime","common/vendor"]]]);